<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¥ç¦æ®·èŒ‚é“œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: KaiTi, "æ¥·ä½“_GB2312", serif;
        }

        body {
            background-color: #f0f8ff;
            text-align: center;
            padding: 50px 0;
        }

        .title {
            color: #e91e63;
            font-size: 28px;
            margin-bottom: 40px;
        }

        .btn-group {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 50px;
        }

        .btn {
            background-color: #e91e63;
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 18px;
            padding: 12px 30px;
            cursor: pointer;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .btn:hover {
            transform: scale(1.05);
            opacity: 0.9;
        }

        .btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            transform: none;
            opacity: 1;
        }

        .blessing-popup {
            position: fixed;
            width: 220px;
            height: 100px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 15px;
            text-align: center;
            font-size: 16px;
            animation: popIn 0.3s ease-out forwards;
            z-index: 1000;
        }

        @keyframes popIn {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            80% {
                transform: scale(1.05);
                opacity: 1;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .close-btn {
            position: absolute;
            top: 5px;
            right: 8px;
            background: none;
            border: none;
            color: #333;
            font-size: 18px;
            cursor: pointer;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            transition: color 0.2s ease;
        }

        .close-btn:hover {
            color: #e91e63;
        }
    </style>
</head>
<body>
    <h1 class="title">ç‚¹å‡»å¼€å§‹æ¥æ”¶ç¥ç¦å§ï¼</h1>
    <div class="btn-group">
        <button id="startBtn" class="btn">å¼€å¯ç¥ç¦</button>
        <button id="closeAllBtn" class="btn">å…³é—­æ‰€æœ‰</button>
    </div>

    <script>
        // ç¥ç¦åˆ—è¡¨
        const normalBlessings = [
            "æ®·èŒ‚é“œ",
            "æ®·èŒ‚é“œæ¯å¤©éƒ½æœ‰å¥½å¿ƒæƒ…ï¼",
            "æ®·èŒ‚é“œæˆä¸ºæœ€å¹¸è¿çš„å®å­ï¼",
            "æ®·èŒ‚é“œä¸–ç•Œä¸Šæœ€å¯çˆ±çš„äººï¼",
            "æ®·èŒ‚é“œäººäººéƒ½èƒ½åŠæ—¶å›æ¶ˆæ¯",
            "æ®·èŒ‚é“œåœ¨å­¦æ ¡é‡Œæ¯å¤©éƒ½è½»æ¾",
            "æ¯å¤©éƒ½æƒ³è§åˆ°ä½ ğŸ˜Š",
            "æœ‰ä¸€ä¸ªå¥åº·çš„èº«ä½“ï¼",
            "æ¯å¤©éƒ½èƒ½å¼€å¼€å¿ƒå¿ƒï¼",
            "æ®·èŒ‚é“œå®¶äººéƒ½å¥å¥åº·åº·ï¼"
        ];
        const specialBlessing = "æ®·èŒ‚é“œæ˜¯ç”·é€š";

        // èƒŒæ™¯è‰²åˆ—è¡¨
        const bgColors = [
            "#ffc0cb", "#ffb6c1", "#ff69b4", "#ff1493", "#db7093",
            "#bc8f8f", "#c71585", "#ffa07a", "#ff7f50", "#ffa500",
            "#ffffe0", "#e6e6fa", "#d8bfd8", "#dda0dd", "#ee82ee"
        ];

        const startBtn = document.getElementById("startBtn");
        const closeAllBtn = document.getElementById("closeAllBtn");
        let popupCount = 0; // è®°å½•å·²ç”Ÿæˆçš„å¼¹çª—æ•°é‡
        let specialBlessingShown = false; // ç‰¹æ®Šç¥ç¦æ˜¯å¦å·²æ˜¾ç¤º

        // ç”Ÿæˆéšæœºä½ç½®ï¼ˆç¡®ä¿ä¸è¶…å‡ºå±å¹•ï¼‰
        function getRandomPosition() {
            const windowWidth = window.innerWidth;
            const windowHeight = window.innerHeight;
            const popupWidth = 220;
            const popupHeight = 100;

            // ç¡®ä¿å¼¹çª—å®Œå…¨åœ¨è§†å£å†…
            const maxLeft = windowWidth - popupWidth - 20;
            const maxTop = windowHeight - popupHeight - 20;

            const left = Math.max(20, Math.floor(Math.random() * maxLeft));
            const top = Math.max(20, Math.floor(Math.random() * maxTop));

            return { left, top };
        }

        // åˆ›å»ºå•ä¸ªç¥ç¦å¼¹çª—
        function createBlessingPopup() {
            if (popupCount >= 100) return;

            const popup = document.createElement("div");
            popup.className = "blessing-popup";

            // éšæœºé€‰æ‹©èƒŒæ™¯è‰²
            const randomBgColor = bgColors[Math.floor(Math.random() * bgColors.length)];
            popup.style.backgroundColor = randomBgColor;

            // éšæœºé€‰æ‹©ç¥ç¦å†…å®¹ï¼ˆ10%æ¦‚ç‡ç‰¹æ®Šç¥ç¦ï¼Œä¸”ä»…æ˜¾ç¤ºä¸€æ¬¡ï¼‰
            let blessingContent;
            if (!specialBlessingShown && Math.random() < 0.1) {
                blessingContent = specialBlessing;
                specialBlessingShown = true;
            } else {
                blessingContent = normalBlessings[Math.floor(Math.random() * normalBlessings.length)];
            }

            // åˆ›å»ºå…³é—­æŒ‰é’®
            const closeBtn = document.createElement("button");
            closeBtn.className = "close-btn";
            closeBtn.textContent = "Ã—";
            closeBtn.addEventListener("click", () => {
                popup.remove();
                popupCount--;
            });

            // ç»„è£…å¼¹çª—
            popup.textContent = blessingContent;
            popup.appendChild(closeBtn);

            // è®¾ç½®éšæœºä½ç½®
            const { left, top } = getRandomPosition();
            popup.style.left = `${left}px`;
            popup.style.top = `${top}px`;

            // æ·»åŠ åˆ°é¡µé¢
            document.body.appendChild(popup);
            popupCount++;
        }

        // å¼€å¯ç¥ç¦æŒ‰é’®äº‹ä»¶
        startBtn.addEventListener("click", () => {
            // ç¦ç”¨æŒ‰é’®5ç§’
            startBtn.disabled = true;
            setTimeout(() => {
                startBtn.disabled = false;
            }, 5000);

            // é‡ç½®ç‰¹æ®Šç¥ç¦çŠ¶æ€
            specialBlessingShown = false;

            // æ¯éš”50msç”Ÿæˆä¸€ä¸ªå¼¹çª—ï¼Œå…±100ä¸ª
            let interval = setInterval(() => {
                createBlessingPopup();
                if (popupCount >= 100) {
                    clearInterval(interval);
                }
            }, 50);
        });

        // å…³é—­æ‰€æœ‰æŒ‰é’®äº‹ä»¶
        closeAllBtn.addEventListener("click", () => {
            // ç§»é™¤æ‰€æœ‰å¼¹çª—
            const allPopups = document.querySelectorAll(".blessing-popup");
            allPopups.forEach(popup => popup.remove());
            popupCount = 0;

            // é‡ç½®ç‰¹æ®Šç¥ç¦çŠ¶æ€
            specialBlessingShown = false;

            // æ¢å¤å¼€å¯ç¥ç¦æŒ‰é’®å¯ç”¨
            startBtn.disabled = false;
        });
    </script>
</body>
</html>